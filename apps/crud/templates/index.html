<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CRUD with Flask and SQLite</title>
    <script>
      async function fetchItems() {
        const response = await fetch("/crud/items");
        const items = await response.json();
        const itemList = document.getElementById("item-list");
        itemList.innerHTML = "";

        items.forEach((item) => {
          const listItem = document.createElement("li");
          listItem.textContent = `ID: ${item.id}, Name: ${item.name}, Description: ${item.description}`;
          itemList.appendChild(listItem);
        });
      }

      async function addItem() {
        const name = document.getElementById("name").value;
        const description = document.getElementById("description").value;

        const response = await fetch("/crud/items", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ name, description }),
        });

        const result = await response.json();

        fetchItems();
      }

      async function deleteItem() {
        const itemId = document.getElementById("delete-id").value;

        await fetch(`/crud/items/${itemId}`, {
          method: "DELETE",
        });

        fetchItems();
      }

      window.onload = fetchItems;
    </script>
  </head>
  <body>
    <h1>CRUD with Flask and SQLite</h1>

    <section>
      <h2>Add Item</h2>
      <form onsubmit="event.preventDefault(); addItem();">
        <label for="name">Name:</label>
        <input type="text" id="name" required />
        <br />
        <label for="description">Description:</label>
        <input type="text" id="description" />
        <br />
        <button type="submit">Add Item</button>
      </form>
    </section>

    <section>
      <h2>Delete Item</h2>
      <form onsubmit="event.preventDefault(); deleteItem();">
        <label for="delete-id">Item ID:</label>
        <input type="number" id="delete-id" required />
        <button type="submit">Delete Item</button>
      </form>
    </section>

    <section>
      <h2>Items</h2>
      <ul id="item-list"></ul>
    </section>
  </body>
</html>
